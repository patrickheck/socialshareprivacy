/*
 * jquery.socialshareprivacy.js | 2 Klicks fuer mehr Datenschutz
 *
 * http://www.heise.de/extras/socialshareprivacy/
 * http://www.heise.de/ct/artikel/2-Klicks-fuer-mehr-Datenschutz-1333879.html
 *
 * Copyright (c) 2011 Hilko Holweg, Sebastian Hilbig, Nicolas Heiringhoff, Juergen Schmidt
 * Heise Zeitschriften Verlag GmbH & Co. KG, http://www.heise.de,
 *
 * Copyright (c) 2011 Tilmann Kuhn
 * object-zoo, http://www.object-zoo.net
 *
 * is released under the MIT License http://www.opensource.org/licenses/mit-license.php
 *
 * Spread the word, link to us if you can.
 */(function(e){"use strict";function t(e,t){var n=decodeURIComponent(e);if(n.length<=t)return e;var r=n.substring(0,t-1).lastIndexOf(" ");n=encodeURIComponent(n.substring(0,r))+"â€¦";return n}function n(t){var n=e('meta[name="'+t+'"]').attr("content");return n||""}function r(){var t=n("DC.title"),r=n("DC.creator");t.length>0&&r.length>0?t+=" - "+r:t=e("title").text();return encodeURIComponent(t)}function i(){var t=document.location.href,n=e("link[rel=canonical]").attr("href");if(n&&n.length>0){n.indexOf("http")<0&&(n=document.location.protocol+"//"+document.location.host+n);t=n}return t}function s(e,t,n,r,i){var s=new Date;s.setTime(s.getTime()+n*24*60*60*1e3);document.cookie=e+"="+t+"; expires="+s.toUTCString()+"; path="+r+"; domain="+i}function o(e,t,n,r){var i=new Date;i.setTime(i.getTime()-100);document.cookie=e+"="+t+"; expires="+i.toUTCString()+"; path="+n+"; domain="+r}e.fn.socialSharePrivacy=function(n){var u={services:{facebook:{status:"on",dummy_img:"",txt_info:"2 Klicks f&uuml;r mehr Datenschutz: Erst wenn Sie hier klicken, wird der Button aktiv und Sie k&ouml;nnen Ihre Empfehlung an Facebook senden. Schon beim Aktivieren werden Daten an Dritte &uuml;bertragen &ndash; siehe <em>i</em>.",txt_fb_off:"nicht mit Facebook verbunden",txt_fb_on:"mit Facebook verbunden",perma_option:"on",display_name:"Facebook",referrer_track:"",language:"de_DE",action:"recommend",dummy_caption:"Empfehlen"},twitter:{status:"on",dummy_img:"",txt_info:"2 Klicks f&uuml;r mehr Datenschutz: Erst wenn Sie hier klicken, wird der Button aktiv und Sie k&ouml;nnen Ihre Empfehlung an Twitter senden. Schon beim Aktivieren werden Daten an Dritte &uuml;bertragen &ndash; siehe <em>i</em>.",txt_twitter_off:"nicht mit Twitter verbunden",txt_twitter_on:"mit Twitter verbunden",perma_option:"on",display_name:"Twitter",referrer_track:"",tweet_text:r,language:"en",dummy_caption:"Tweet"},gplus:{status:"on",dummy_img:"",txt_info:"2 Klicks f&uuml;r mehr Datenschutz: Erst wenn Sie hier klicken, wird der Button aktiv und Sie k&ouml;nnen Ihre Empfehlung an Google+ senden. Schon beim Aktivieren werden Daten an Dritte &uuml;bertragen &ndash; siehe <em>i</em>.",txt_gplus_off:"nicht mit Google+ verbunden",txt_gplus_on:"mit Google+ verbunden",perma_option:"on",display_name:"Google+",referrer_track:"",language:"de"}},info_link:"http://www.heise.de/ct/artikel/2-Klicks-fuer-mehr-Datenschutz-1333879.html",txt_help:"Wenn Sie diese Felder durch einen Klick aktivieren, werden Informationen an Facebook, Twitter oder Google in die USA &uuml;bertragen und unter Umst&auml;nden auch dort gespeichert. N&auml;heres erfahren Sie durch einen Klick auf das <em>i</em>.",settings_perma:"Dauerhaft aktivieren und Daten&uuml;ber&shy;tragung zustimmen:",cookie_path:"/",cookie_domain:document.location.host,cookie_expires:"365",css_path:"socialshareprivacy/socialshareprivacy.css",uri:i},a=e.extend(!0,u,n),f=a.services.facebook.status==="on",l=a.services.twitter.status==="on",c=a.services.gplus.status==="on";if(!f&&!l&&!c)return;a.css_path.length>0&&(document.createStyleSheet?document.createStyleSheet(a.css_path):e("head").append('<link rel="stylesheet" type="text/css" href="'+a.css_path+'" />'));return this.each(function(){e(this).prepend('<ul class="social_share_privacy_area"></ul>');var n=e(".social_share_privacy_area",this),r=a.uri;typeof r=="function"&&(r=r(n));if(f){var i=encodeURIComponent(r+a.services.facebook.referrer_track),u='<iframe src="http://www.facebook.com/plugins/like.php?locale='+a.services.facebook.language+"&amp;href="+i+"&amp;send=false&amp;layout=button_count&amp;width=120&amp;show_faces=false&amp;action="+a.services.facebook.action+'&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:145px; height:21px;" allowTransparency="true"></iframe>',h;a.services.facebook.dummy_img?h='<img class="fb_like_privacy_dummy" src="'+a.services.facebook.dummy_img+'" alt="'+a.services.facebook.dummy_caption+'" />':h='<div class="fb_like_privacy_dummy"><span>'+a.services.facebook.dummy_caption+"</span></div>";n.append('<li class="facebook help_info"><span class="info">'+a.services.facebook.txt_info+'</span><span class="switch off">'+a.services.facebook.txt_fb_off+'</span><div class="fb_like dummy_btn">'+h+"</div></li>");var p=e("li.facebook",n);n.on("click","li.facebook div.fb_like .fb_like_privacy_dummy,li.facebook span.switch",function(){if(p.find("span.switch").hasClass("off")){p.addClass("info_off");p.find("span.switch").addClass("on").removeClass("off").html(a.services.facebook.txt_fb_on);p.find(".fb_like_privacy_dummy").replaceWith(u)}else{p.removeClass("info_off");p.find("span.switch").addClass("off").removeClass("on").html(a.services.facebook.txt_fb_off);p.find(".fb_like").html(h)}})}if(l){var d=a.services.twitter.tweet_text;typeof d=="function"&&(d=d());d=t(d,"120");var v=encodeURIComponent(r+a.services.twitter.referrer_track),m=encodeURIComponent(r),g='<iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url='+v+"&amp;counturl="+m+"&amp;text="+d+"&amp;count=horizontal&amp;lang="+a.services.twitter.language+'" style="width:130px; height:25px;"></iframe>',y;a.services.twitter.dummy_img?y='<img class="tweet_this_dummy" src="'+a.services.twitter.dummy_img+'" alt="'+a.services.twitter.dummy_caption+'" />':y='<div class="tweet_this_dummy"><span>'+a.services.twitter.dummy_caption+"</span></div>";n.append('<li class="twitter help_info"><span class="info">'+a.services.twitter.txt_info+'</span><span class="switch off">'+a.services.twitter.txt_twitter_off+'</span><div class="tweet dummy_btn">'+y+"</div></li>");var b=e("li.twitter",n);n.on("click","li.twitter .tweet_this_dummy,li.twitter span.switch",function(){if(b.find("span.switch").hasClass("off")){b.addClass("info_off");b.find("span.switch").addClass("on").removeClass("off").html(a.services.twitter.txt_twitter_on);b.find(".tweet_this_dummy").replaceWith(g)}else{b.removeClass("info_off");b.find("span.switch").addClass("off").removeClass("on").html(a.services.twitter.txt_twitter_off);b.find(".tweet").html(y)}})}if(c){var w=r+a.services.gplus.referrer_track,E='<div class="g-plusone" data-size="medium" data-href="'+w+'"></div><script type="text/javascript">window.___gcfg = {lang: "'+a.services.gplus.language+'"}; (function() { var po = document.createElement("script"); po.type = "text/javascript"; po.async = true; po.src = "https://apis.google.com/js/plusone.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(po, s); })(); </script>',S;a.services.gplus.dummy_img?S='<img src="'+a.services.gplus.dummy_img+'" alt="+1" class="gplus_one_dummy" />':S='<div class="gplus_one_dummy">+1</div>';n.append('<li class="gplus help_info"><span class="info">'+a.services.gplus.txt_info+'</span><span class="switch off">'+a.services.gplus.txt_gplus_off+'</span><div class="gplusone dummy_btn">'+S+"</div></li>");var x=e("li.gplus",n);n.on("click","li.gplus div.gplusone .gplus_one_dummy,li.gplus span.switch",function(){if(x.find("span.switch").hasClass("off")){x.addClass("info_off");x.find("span.switch").addClass("on").removeClass("off").html(a.services.gplus.txt_gplus_on);x.find(".gplus_one_dummy").replaceWith(E)}else{x.removeClass("info_off");x.find("span.switch").addClass("off").removeClass("on").html(a.services.gplus.txt_gplus_off);x.find(".gplusone").html(S)}})}n.append('<li class="settings_info"><div class="settings_info_menu off perma_option_off"><a href="'+a.info_link+'"><span class="help_info icon"><span class="info">'+a.txt_help+"</span></span></a></div></li>");n.on("mousenenter",".help_info:not(.info_off)",function(){var t=e(this),n=window.setTimeout(function(){e(t).addClass("display")},500);e(this).data("timeout_id",n)});n.on("mouseleave",".help_info",function(){var t=e(this).data("timeout_id");window.clearTimeout(t);e(this).hasClass("display")&&e(this).removeClass("display")});var T=a.services.facebook.perma_option==="on",N=a.services.twitter.perma_option==="on",C=a.services.gplus.perma_option==="on";if((f&&T||l&&N||c&&C)&&(!e.browser.msie||e.browser.msie&&e.browser.version>7)){var k=document.cookie.split(";"),L="{",A=0;for(;A<k.length;A+=1){var O=k[A].split("=");L+='"'+e.trim(O[0])+'":"'+e.trim(O[1])+'"';A<k.length-1&&(L+=",")}L+="}";L=JSON.parse(L);var M=e("li.settings_info",n);M.find(".settings_info_menu").removeClass("perma_option_off");M.find(".settings_info_menu").append('<span class="settings">Einstellungen</span><form><fieldset><legend>'+a.settings_perma+"</legend></fieldset></form>");var _=' checked="checked"';if(f&&T){var D=L.socialSharePrivacy_facebook==="perma_on"?_:"";M.find("form fieldset").append('<input type="checkbox" name="perma_status_facebook" id="perma_status_facebook"'+D+' /><label for="perma_status_facebook">'+a.services.facebook.display_name+"</label>")}if(l&&N){var P=L.socialSharePrivacy_twitter==="perma_on"?_:"";M.find("form fieldset").append('<input type="checkbox" name="perma_status_twitter" id="perma_status_twitter"'+P+' /><label for="perma_status_twitter">'+a.services.twitter.display_name+"</label>")}if(c&&C){var H=L.socialSharePrivacy_gplus==="perma_on"?_:"";M.find("form fieldset").append('<input type="checkbox" name="perma_status_gplus" id="perma_status_gplus"'+H+' /><label for="perma_status_gplus">'+a.services.gplus.display_name+"</label>")}M.find("span.settings").css("cursor","pointer");n.on("mouseenter",M.find("span.settings"),function(){var t=window.setTimeout(function(){M.find(".settings_info_menu").removeClass("off").addClass("on")},500);e(this).data("timeout_id",t)});n.on("mouseleave",M,function(){var t=e(this).data("timeout_id");window.clearTimeout(t);M.find(".settings_info_menu").removeClass("on").addClass("off")});n.on("click",M.find("fieldset input"),function(t){var r=t.target.id,i=r.substr(r.lastIndexOf("_")+1,r.length),u="socialSharePrivacy_"+i;if(e("#"+t.target.id+":checked").length){s(u,"perma_on",a.cookie_expires,a.cookie_path,a.cookie_domain);e("form fieldset label[for="+r+"]",n).addClass("checked")}else{o(u,"perma_on",a.cookie_path,a.cookie_domain);e("form fieldset label[for="+r+"]",n).removeClass("checked")}});f&&T&&L.socialSharePrivacy_facebook==="perma_on"&&e("li.facebook span.switch",n).click();l&&N&&L.socialSharePrivacy_twitter==="perma_on"&&e("li.twitter span.switch",n).click();c&&C&&L.socialSharePrivacy_gplus==="perma_on"&&e("li.gplus span.switch",n).click()}})}})(jQuery);